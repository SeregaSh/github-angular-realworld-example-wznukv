{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ArticlesService, UserService } from '../../core';\nimport { of } from 'rxjs';\nimport { concatMap, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../core\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\n\nconst _c0 = function (a0, a1, a2) {\n  return {\n    \"disabled\": a0,\n    \"btn-outline-primary\": a1,\n    \"btn-primary\": a2\n  };\n};\n\nconst _c1 = [\"*\"];\nexport let FavoriteButtonComponent = /*#__PURE__*/(() => {\n  class FavoriteButtonComponent {\n    constructor(articlesService, router, userService) {\n      this.articlesService = articlesService;\n      this.router = router;\n      this.userService = userService;\n      this.toggle = new EventEmitter();\n      this.isSubmitting = false;\n    }\n\n    toggleFavorite() {\n      this.isSubmitting = true;\n      this.userService.isAuthenticated.pipe(concatMap(authenticated => {\n        // Not authenticated? Push to login screen\n        if (!authenticated) {\n          this.router.navigateByUrl('/login');\n          return of(null);\n        } // Favorite the article if it isn't favorited yet\n\n\n        if (!this.article.favorited) {\n          return this.articlesService.favorite(this.article.slug).pipe(tap(data => {\n            this.isSubmitting = false;\n            this.toggle.emit(true);\n          }, err => this.isSubmitting = false)); // Otherwise, unfavorite the article\n        } else {\n          return this.articlesService.unfavorite(this.article.slug).pipe(tap(data => {\n            this.isSubmitting = false;\n            this.toggle.emit(false);\n          }, err => this.isSubmitting = false));\n        }\n      })).subscribe();\n    }\n\n  }\n\n  FavoriteButtonComponent.ɵfac = function FavoriteButtonComponent_Factory(t) {\n    return new (t || FavoriteButtonComponent)(i0.ɵɵdirectiveInject(i1.ArticlesService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i1.UserService));\n  };\n\n  FavoriteButtonComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FavoriteButtonComponent,\n    selectors: [[\"app-favorite-button\"]],\n    inputs: {\n      article: \"article\"\n    },\n    outputs: {\n      toggle: \"toggle\"\n    },\n    ngContentSelectors: _c1,\n    decls: 3,\n    vars: 5,\n    consts: [[1, \"btn\", \"btn-sm\", 3, \"ngClass\", \"click\"], [1, \"ion-heart\"]],\n    template: function FavoriteButtonComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵprojectionDef();\n        i0.ɵɵelementStart(0, \"button\", 0);\n        i0.ɵɵlistener(\"click\", function FavoriteButtonComponent_Template_button_click_0_listener() {\n          return ctx.toggleFavorite();\n        });\n        i0.ɵɵelement(1, \"i\", 1);\n        i0.ɵɵprojection(2);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(1, _c0, ctx.isSubmitting, !ctx.article.favorited, ctx.article.favorited));\n      }\n    },\n    dependencies: [i3.NgClass],\n    encapsulation: 2\n  });\n  return FavoriteButtonComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}